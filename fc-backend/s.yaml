edition: 1.0.0
name: fc-ai-assistant-backend
# 请确保你已通过 `s config add` 配置了阿里云密钥，并在此处填写你的密钥别名
access: "default"

vars: # 全局变量
  # 部署的地域，你需要根据你的需要修改
  region: "cn-hongkong"

services:
  AIAssistantAPI: # 项目下的服务
    component: fc
    props:
      region: ${vars.region}
      service:
        name: "ai-assistant-service"
        description: 'AI 助手 API 服务'
        internetAccess: true
      function:
        name: "ai-assistant-handler"
        description: '处理 AI 对话请求的函数'
        runtime: nodejs16
        codeUri: ./
        handler: index.handler
        memorySize: 512
        timeout: 60
        environmentVariables:
          # 在这里存放你的 AI 服务 API Key，这比硬编码在代码里更安全
          # 部署时，Serverless Devs 会自动读取你电脑的环境变量 DEEPSEEK_API_KEY
          DEEPSEEK_API_KEY: ${env.DEEPSEEK_API_KEY}
          # 您的网站域名，用于跨域许可
          CORS_ALLOWED_ORIGIN: 'http://www.galahad.website'
      triggers:
        - name: http-trigger
          type: http
          config:
            authType: anonymous
            methods:
              - POST
              - OPTIONS # OPTIONS 请求用于浏览器跨域时的预检
